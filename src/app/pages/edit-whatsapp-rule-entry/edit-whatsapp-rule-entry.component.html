<div style="height: 100%;background-color: #ffffff94 !important;" *ngIf="showComponentLoader">
	<div class="loader" style="position: fixed;top: 50%;left: 50%;">
		<img src="/assets/orange-loader.gif" class="ajax-loader" style="width:50px;">
	</div>
</div>
<div style="margin-left:7%" fxLayout="column" class="components-container-gt-xs" [ngClass.xs]="'components-container-xs'" fxLayoutGap="20px">
	<div *ngIf="!showComponentLoader">
		<h2 style="font-family: ProximaNovaLight,sans-serif;font-weight: normal;line-height: 0px">Edit Rule Entry</h2>
	</div>
	<div *ngIf="!showComponentLoader">
		<h2 style="font-weight: normal;line-height: 0px">1. Criteria</h2>
		<table id="searchlayer" border="0" cellpadding="0" cellspacing="0"
			class=" newApCriteriaTable newCriUi CRE sandboxDiffChanges">
			<fieldset class="standard">
				<legend>
					<legend>Add Criteria
						<!-- <button style="margin-left:10px;min-width:50px !important;" mat-raised-button (click)="addnewrow()">
							<mat-icon>add</mat-icon>
						</button> -->
					</legend>
				</legend>
				<tbody>
					<tr *ngFor="let field of fieldArray; let i = index">
						<td>
							<div class="wf_slideDownUp_Div tr_cnt_2"
								style="height: auto; opacity: 1; overflow: visible;">
								<div class="andOrOp" *ngIf="i != 0">
									<label id="matchConditionLabel2" class="cus_cb_label">
										<input type="checkbox" id="condition_inp2" class="cus_cb_inp"
											[(ngModel)]="field.andOr" (change)="changeAndOr(field.andOr, i)">
										<span class="cus_cb_sp">
											<span id="matchCndtnAnd2" class="cus_cb_and alink">AND</span>
											<span id="matchCndtnOr2" class="cus_cb_or alink">OR</span>
										</span>
									</label>
								</div>
								<input id="patternNum2" type="text" class="searchMatchText" readonly="readonly"
									[value]="i + 1">
							</div>
						</td>
						<td>
							<mat-form-field style="width: 134px;margin-left: 20px;margin-top: -4px;">
								<mat-select (selectionChange)="selectField(field, i)" [(ngModel)]="field.rule_name">
									<mat-option value="">None</mat-option>
									<mat-option [value]="rule" *ngFor="let rule of entries">{{rule.name}}</mat-option>
								</mat-select>
							</mat-form-field>
						</td>
						<td>
							<mat-form-field style="width: 134px;margin-left: 20px;margin-top: -4px;">
								<mat-select [(ngModel)]="field.rule_operator"
									(selectionChange)="selectOperator(field, i)"
									[disabled]="field.rule_name == undefined || field.rule_name == ''">
									<mat-option value="">None</mat-option>
									<mat-option [value]="key" *ngFor="let key of field.operatorsByFeild">{{key}}
									</mat-option>
								</mat-select>
							</mat-form-field>
						</td>
						<td>

							<select style="width:200px;margin-bottom: 15px !important;padding: 12px;
							border: 1px solid #ccc;
							border-radius: 4px;" [(ngModel)]="field.between_one"
								*ngIf="field.rule_name.name_value == 'score' && field.rule_operator == 'between' && !field.rule_operator_contains  && (field.rule_name != undefined || field.rule_name != '' || field.rule_operator != undefined || field.rule_operator != '' || field.rule_operator != 'is empty' || field.rule_operator != 'is not empty')">
								<option value="1">1</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5</option>
								<option value="6">6</option>
								<option value="7">7</option>
								<option value="8">8</option>
								<option value="9">9</option>
								<option value="10">10</option>
								<option value="11">11</option>
								<option value="12">12</option>
								<option value="13">13</option>
								<option value="14">14</option>
								<option value="15">15</option>
								<option value="16">16</option>
								<option value="17">17</option>
								<option value="18">18</option>
								<option value="19">19</option>
								<option value="20">20</option>
							</select>
							<select style="width:200px;margin-bottom: 15px !important;padding: 12px;
							border: 1px solid #ccc;
							border-radius: 4px;margin-left:20px;" [(ngModel)]="field.between_two"
								*ngIf="field.rule_name.name_value == 'score' && field.rule_operator == 'between' && !field.rule_operator_contains  && (field.rule_name != undefined || field.rule_name != '' || field.rule_operator != undefined || field.rule_operator != '' || field.rule_operator != 'is empty' || field.rule_operator != 'is not empty')">
								<option value="1">1</option>
								<option value="2">2</option>
								<option value="3">3</option>
								<option value="4">4</option>
								<option value="5">5</option>
								<option value="6">6</option>
								<option value="7">7</option>
								<option value="8">8</option>
								<option value="9">9</option>
								<option value="10">10</option>
								<option value="11">11</option>
								<option value="12">12</option>
								<option value="13">13</option>
								<option value="14">14</option>
								<option value="15">15</option>
								<option value="16">16</option>
								<option value="17">17</option>
								<option value="18">18</option>
								<option value="19">19</option>
								<option value="20">20</option>
							</select>
							<mat-form-field *ngIf="field.rule_operator != 'between'"
								style="width:475px; margin-left: 20px;margin-top: -4px;">
								<input matInput [(ngModel)]="field.rule_value" disabled style="background:#d6d6d6"
									*ngIf="field.rule_name == undefined || field.rule_name == '' || field.rule_operator == undefined || field.rule_operator == '' || field.rule_operator == 'is empty' || field.rule_operator == 'is not empty' && !field.rule_operator_contains && !field.rule_operator_isnt">

								<input matInput [(ngModel)]="field.rule_value"
									*ngIf="field.rule_name.name_value == 'source' && (field.rule_operator == 'is' || field.rule_operator_isnt) && !field.rule_operator_contains  && (field.rule_name != undefined || field.rule_name != '' || field.rule_operator != undefined || field.rule_operator != '' || field.rule_operator != 'is empty' || field.rule_operator != 'is not empty')">

								<!-- for between -->
								<input matInput type="number" min="1" max="5"
									style="width:200px;border: 1px solid;padding: 3px;" [(ngModel)]="field.between_one"
									*ngIf="field.rule_name.name_value == 'score' && field.rule_operator == 'between' && !field.rule_operator_contains  && (field.rule_name != undefined || field.rule_name != '' || field.rule_operator != undefined || field.rule_operator != '' || field.rule_operator != 'is empty' || field.rule_operator != 'is not empty')">
								<input matInput type="number" min="1" max="5"
									style="width:200px;border: 1px solid;padding: 3px;margin-left:20px;"
									[(ngModel)]="field.between_two"
									*ngIf="field.rule_name.name_value == 'score' && field.rule_operator == 'between' && !field.rule_operator_contains  && (field.rule_name != undefined || field.rule_name != '' || field.rule_operator != undefined || field.rule_operator != '' || field.rule_operator != 'is empty' || field.rule_operator != 'is not empty')">

								<mat-chip-list #chipList
									*ngIf="field.rule_name.name_value == 'source' && (field.rule_operator == 'contains' || field.rule_operator_contains) && !field.rule_operator_isnt && (field.rule_name != undefined || field.rule_name != '' || field.rule_operator != undefined || field.rule_operator != '' || field.rule_operator != 'is empty' || field.rule_operator != 'is not empty')">
									<mat-chip *ngFor="let value of field.rule_value" [selectable]="selectable"
										[removable]="removable" (removed)="remove(value, i)">
										{{value}}
										<mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
									</mat-chip>
									<input placeholder="Add Value..." [matChipInputFor]="chipList"
										[matChipInputSeparatorKeyCodes]="separatorKeysCodes"
										[matChipInputAddOnBlur]="addOnBlur" (matChipInputTokenEnd)="add($event, i)">
								</mat-chip-list>
								<mat-select [(ngModel)]="field.rule_value"
									*ngIf="field.rule_name.name_value == 'score' && (field.rule_operator == '=' || field.rule_operator == '!=' || field.rule_operator == '<' || field.rule_operator == '<=' || field.rule_operator == '>=' || field.rule_operator == '>') && !field.rule_operator_contains && (field.rule_name != undefined || field.rule_name != '' || field.rule_operator != undefined || field.rule_operator != '' || field.rule_operator != 'is empty' || field.rule_operator != 'is not empty') && !field.rule_operator_isnt">
									<mat-option value="1">1</mat-option>
									<mat-option value="2">2</mat-option>
									<mat-option value="3">3</mat-option>
									<mat-option value="4">4</mat-option>
									<mat-option value="5">5</mat-option>
									<mat-option value="6">6</mat-option>
									<mat-option value="7">7</mat-option>
									<mat-option value="8">8</mat-option>
									<mat-option value="9">9</mat-option>
									<mat-option value="10">10</mat-option>
									<mat-option value="11">11</mat-option>
									<mat-option value="12">12</mat-option>
									<mat-option value="13">13</mat-option>
									<mat-option value="14">14</mat-option>
									<mat-option value="15">15</mat-option>
									<mat-option value="16">16</mat-option>
									<mat-option value="17">17</mat-option>
									<mat-option value="18">18</mat-option>
									<mat-option value="19">19</mat-option>
									<mat-option value="20">20</mat-option>
								</mat-select>
								<mat-select multiple [(ngModel)]="field.rule_value"
									*ngIf="field.rule_name.name_value == 'score' && (field.rule_operator == 'contains' || field.rule_operator_contains) && (field.rule_name != undefined || field.rule_name != '' || field.rule_operator != undefined || field.rule_operator != '' || field.rule_operator != 'is empty' || field.rule_operator != 'is not empty') && !field.rule_operator_isnt">
									<mat-option value="1">1</mat-option>
									<mat-option value="2">2</mat-option>
									<mat-option value="3">3</mat-option>
									<mat-option value="4">4</mat-option>
									<mat-option value="5">5</mat-option>
									<mat-option value="6">6</mat-option>
									<mat-option value="7">7</mat-option>
									<mat-option value="8">8</mat-option>
									<mat-option value="9">9</mat-option>
									<mat-option value="10">10</mat-option>
									<mat-option value="11">11</mat-option>
									<mat-option value="12">12</mat-option>
									<mat-option value="13">13</mat-option>
									<mat-option value="14">14</mat-option>
									<mat-option value="15">15</mat-option>
									<mat-option value="16">16</mat-option>
									<mat-option value="17">17</mat-option>
									<mat-option value="18">18</mat-option>
									<mat-option value="19">19</mat-option>
									<mat-option value="20">20</mat-option>
								</mat-select>
							</mat-form-field>
						</td>
						<td style="vertical-align: middle !important;">
							<span *ngIf="i != 0">
								<mat-icon style="cursor:pointer; margin-left: 20px;" (click)="deleteFieldValue(i)">
									remove</mat-icon>
							</span>
							<span *ngIf="fieldArray.length == i+1">
								<mat-icon style="cursor:pointer; margin-left: 20px;color:blue;" (click)="addnewrow()">
									add</mat-icon>
							</span>
						</td>
					</tr>
				</tbody>
			</fieldset>
			<div style="padding:20px;" *ngIf="!editPattern && fieldArray.length > 1">
				<span>Rule Pattern</span>
				<span class="pL0 dIB vam color_3 Proxima cri_pattern"
					style="max-width: 55%;display: inline-block;border-bottom: 1px solid;word-wrap: break-word;margin-left: 20px;vertical-align: middle;"
					id="pattern">{{pattern}}</span>
				<a href="javascript:void(0);" class="mL10 link1 f13 proxima dIB vam" id="editPattern"
					style="margin-left:20px;" (click)="editPatternClick()">Edit
					Pattern</a>
			</div>
			<div style="padding:20px;" *ngIf="editPattern">
				<span>Rule Pattern</span>
				<div class="newinputText  p0 vam new_pattern_ui"
					style="width: 55%;display: initial;margin-left: 20px;vertical-align: middle;">
					<textarea name="patternVal" id="patternVal" class="patternVal dB resizeNone" rows="1"
						style="width: 55%; border: 1px solid #a4a4a4; height: 55px;"
						[(ngModel)]="textAreaPattern"></textarea>
				</div>
				<div class="alignright dIB vam pA" id="updatePattern"
					style="right: 0px; bottom: 7px; display: inline-block;">
					<a href="javascript:void(0);" id="saveChangePattern" class="link1 f13 proxima"
						(click)="savePatternClick()" style="margin-left:20px;">Save</a>
					<a href="javascript:void(0);" id="cancelChangePattern" class="greyText mL5 f13 proxima"
						(click)="cancelPatternClick()" style="margin-left:10px;">Cancel</a></div>
			</div>
		</table>
	</div>
	
	<div *ngIf="!showComponentLoader" class="mT20 rule-button-margin" id="cvbutton">
		<input name="Input" class="primarybtn" type="button" (click)="saveRuleEntry()" value="Update" id="getUserLists">
		<input name="cancel" class="newgraybtn" type="button" value="Cancel" (click)="cancelRuleEntry()">
	</div>
</div>